{"ast":null,"code":"import React,{createContext,useContext,useState,useEffect}from'react';import axios from'axios';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const AuthContext=/*#__PURE__*/createContext();export const useAuth=()=>useContext(AuthContext);export const AuthProvider=_ref=>{let{children}=_ref;const[user,setUser]=useState(null);const[error,setError]=useState(null);useEffect(()=>{const token=localStorage.getItem('authToken');if(token){axios.get('/api/profile',{// Ensure this endpoint exists on your server\nheaders:{Authorization:\"Bearer \".concat(token)}}).then(response=>{setUser(response.data);// Assuming 'response.data' contains user data\n}).catch(err=>{setError(err.response?err.response.data.message:'Failed to fetch user data');console.error('Error fetching user data:',err.response?err.response.data:err.message);});}},[]);const loginUser=(email,password)=>{return new Promise((resolve,reject)=>{axios.post('/api/login',{email,password}).then(response=>{if(response.data.token){localStorage.setItem('authToken',response.data.token);setUser(response.data.user);// Assuming 'response.data.user' contains the user data\nresolve(response.data.user);}else{reject('Login error');}}).catch(err=>{reject(err.response?err.response.data.message:'Invalid username or password');});});};const logoutUser=()=>{localStorage.removeItem('authToken');setUser(null);};return/*#__PURE__*/_jsxs(AuthContext.Provider,{value:{user,loginUser,logoutUser},children:[error&&/*#__PURE__*/_jsx(\"div\",{children:error}),\"  \",children]});};","map":{"version":3,"names":["React","createContext","useContext","useState","useEffect","axios","jsx","_jsx","jsxs","_jsxs","AuthContext","useAuth","AuthProvider","_ref","children","user","setUser","error","setError","token","localStorage","getItem","get","headers","Authorization","concat","then","response","data","catch","err","message","console","loginUser","email","password","Promise","resolve","reject","post","setItem","logoutUser","removeItem","Provider","value"],"sources":["D:/Work/event-frontend/src/context/AuthContext.js"],"sourcesContent":["import React, { createContext, useContext, useState, useEffect } from 'react';\r\nimport axios from 'axios';\r\n\r\nconst AuthContext = createContext();\r\n\r\nexport const useAuth = () => useContext(AuthContext);\r\n\r\nexport const AuthProvider = ({ children }) => {\r\n    const [user, setUser] = useState(null);\r\n    const [error, setError] = useState(null);\r\n\r\n    useEffect(() => {\r\n        const token = localStorage.getItem('authToken');\r\n        if (token) {\r\n            axios\r\n                .get('/api/profile', {  // Ensure this endpoint exists on your server\r\n                    headers: {\r\n                        Authorization: `Bearer ${token}`,\r\n                    },\r\n                })\r\n                .then((response) => {\r\n                    setUser(response.data);  // Assuming 'response.data' contains user data\r\n                })\r\n                .catch((err) => {\r\n                    setError(err.response ? err.response.data.message : 'Failed to fetch user data');\r\n                    console.error('Error fetching user data:', err.response ? err.response.data : err.message);\r\n                });\r\n        }\r\n    }, []);\r\n\r\n    const loginUser = (email, password) => {\r\n        return new Promise((resolve, reject) => {\r\n            axios\r\n                .post('/api/login', { email, password })\r\n                .then((response) => {\r\n                    if (response.data.token) {\r\n                        localStorage.setItem('authToken', response.data.token);\r\n                        setUser(response.data.user);  // Assuming 'response.data.user' contains the user data\r\n                        resolve(response.data.user);\r\n                    } else {\r\n                        reject('Login error');\r\n                    }\r\n                })\r\n                .catch((err) => {\r\n                    reject(err.response ? err.response.data.message : 'Invalid username or password');\r\n                });\r\n        });\r\n    };\r\n\r\n    const logoutUser = () => {\r\n        localStorage.removeItem('authToken');\r\n        setUser(null);\r\n    };\r\n\r\n    return (\r\n        <AuthContext.Provider value={{ user, loginUser, logoutUser }}>\r\n            {error && <div>{error}</div>}  {/* Display the error message in the UI */}\r\n            {children}\r\n        </AuthContext.Provider>\r\n    );\r\n};\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}