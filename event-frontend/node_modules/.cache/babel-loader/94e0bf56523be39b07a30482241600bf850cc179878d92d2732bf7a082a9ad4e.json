{"ast":null,"code":"import _objectSpread from\"D:/Work/event-frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useEffect,useState}from'react';import axios from'axios';import{useAuth}from'../context/AuthContext';import'./ProfilePage.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const ProfilePage=()=>{const{user,logoutUser}=useAuth();const[profile,setProfile]=useState(null);const[loading,setLoading]=useState(true);const[error,setError]=useState(null);useEffect(()=>{if(user){setLoading(true);const token=localStorage.getItem('authToken');axios.get('/api/profile',{headers:{Authorization:\"Bearer \".concat(token)},params:{userId:user.id}}).then(response=>{setProfile(response.data);}).catch(err=>{setError('Failed to load profile data');}).finally(()=>setLoading(false));}},[user]);const leaveEvent=eventId=>{const token=localStorage.getItem('authToken');axios.delete('/api/events/leave',{headers:{Authorization:\"Bearer \".concat(token)},data:{userId:user.id,eventId}}).then(()=>{setProfile(prevProfile=>_objectSpread(_objectSpread({},prevProfile),{},{events:prevProfile.events.filter(event=>event.id_event!==eventId)}));}).catch(()=>{alert('Failed to leave event');});};if(!user){return/*#__PURE__*/_jsx(\"div\",{children:\"You are not authorized\"});}if(loading){return/*#__PURE__*/_jsx(\"div\",{children:\"Loading...\"});}if(error){return/*#__PURE__*/_jsx(\"div\",{children:error});}return/*#__PURE__*/_jsxs(\"div\",{className:\"profile-container\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Profile\"}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Name:\"}),\" \",profile===null||profile===void 0?void 0:profile.name]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Surname:\"}),\" \",profile===null||profile===void 0?void 0:profile.surname]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Email:\"}),\" \",profile===null||profile===void 0?void 0:profile.email]}),/*#__PURE__*/_jsx(\"h2\",{children:\"Events\"}),profile!==null&&profile!==void 0&&profile.events&&(profile===null||profile===void 0?void 0:profile.events.length)>0?/*#__PURE__*/_jsx(\"ul\",{children:profile.events.map(event=>/*#__PURE__*/_jsxs(\"li\",{children:[/*#__PURE__*/_jsxs(\"p\",{children:[event.name,\" - \",new Date(event.date).toLocaleDateString()]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>leaveEvent(event.id_event),children:\"Leave\"})]},event.id_event))}):/*#__PURE__*/_jsx(\"p\",{children:\"You are not participating in any events\"}),/*#__PURE__*/_jsx(\"button\",{className:\"logout-btn\",onClick:logoutUser,children:\"Log out\"})]});};export default ProfilePage;","map":{"version":3,"names":["React","useEffect","useState","axios","useAuth","jsx","_jsx","jsxs","_jsxs","ProfilePage","user","logoutUser","profile","setProfile","loading","setLoading","error","setError","token","localStorage","getItem","get","headers","Authorization","concat","params","userId","id","then","response","data","catch","err","finally","leaveEvent","eventId","delete","prevProfile","_objectSpread","events","filter","event","id_event","alert","children","className","name","surname","email","length","map","Date","date","toLocaleDateString","onClick"],"sources":["D:/Work/event-frontend/src/pages/ProfilePage.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport axios from 'axios';\r\nimport { useAuth } from '../context/AuthContext';\r\nimport './ProfilePage.css';\r\n\r\nconst ProfilePage = () => {\r\n    const { user, logoutUser } = useAuth();\r\n    const [profile, setProfile] = useState(null);\r\n    const [loading, setLoading] = useState(true);\r\n    const [error, setError] = useState(null);\r\n\r\n    useEffect(() => {\r\n        if (user) {\r\n            setLoading(true);\r\n            const token = localStorage.getItem('authToken');\r\n            axios\r\n                .get('/api/profile', {\r\n                    headers: {\r\n                        Authorization: `Bearer ${token}`,\r\n                    },\r\n                    params: { userId: user.id },\r\n                })\r\n                .then((response) => {\r\n                    setProfile(response.data);\r\n                })\r\n                .catch((err) => {\r\n                    setError('Failed to load profile data');\r\n                })\r\n                .finally(() => setLoading(false));\r\n        }\r\n    }, [user]);\r\n\r\n    const leaveEvent = (eventId) => {\r\n        const token = localStorage.getItem('authToken');\r\n        axios\r\n            .delete('/api/events/leave', {\r\n                headers: {\r\n                    Authorization: `Bearer ${token}`,\r\n                },\r\n                data: { userId: user.id, eventId },\r\n            })\r\n            .then(() => {\r\n                setProfile((prevProfile) => ({\r\n                    ...prevProfile,\r\n                    events: prevProfile.events.filter((event) => event.id_event !== eventId),\r\n                }));\r\n            })\r\n            .catch(() => {\r\n                alert('Failed to leave event');\r\n            });\r\n    };\r\n\r\n    if (!user) {\r\n        return <div>You are not authorized</div>;\r\n    }\r\n\r\n    if (loading) {\r\n        return <div>Loading...</div>;\r\n    }\r\n\r\n    if (error) {\r\n        return <div>{error}</div>;\r\n    }\r\n\r\n    return (\r\n        <div className=\"profile-container\">\r\n            <h1>Profile</h1>\r\n            <p><strong>Name:</strong> {profile?.name}</p>\r\n            <p><strong>Surname:</strong> {profile?.surname}</p>\r\n            <p><strong>Email:</strong> {profile?.email}</p>\r\n\r\n            <h2>Events</h2>\r\n            {profile?.events && profile?.events.length > 0 ? (\r\n                <ul>\r\n                    {profile.events.map((event) => (\r\n                        <li key={event.id_event}>\r\n                            <p>{event.name} - {new Date(event.date).toLocaleDateString()}</p>\r\n                            <button onClick={() => leaveEvent(event.id_event)}>Leave</button>\r\n                        </li>\r\n                    ))}\r\n                </ul>\r\n            ) : (\r\n                <p>You are not participating in any events</p>\r\n            )}\r\n\r\n            <button className=\"logout-btn\" onClick={logoutUser}>Log out</button>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default ProfilePage;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}