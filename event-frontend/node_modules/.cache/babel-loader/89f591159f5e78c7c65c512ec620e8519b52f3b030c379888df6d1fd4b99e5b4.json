{"ast":null,"code":"import _objectSpread from\"D:/Work/event-frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useEffect,useState}from'react';import axios from'axios';import{useAuth}from'../context/AuthContext';import'./ProfilePage.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const ProfilePage=()=>{const{user,logoutUser}=useAuth();const[profile,setProfile]=useState(null);const[loading,setLoading]=useState(true);const[error,setError]=useState(null);useEffect(()=>{if(user){setLoading(true);const token=localStorage.getItem('authToken');if(!token){setError(\"Token is missing. Please log in again.\");setLoading(false);return;}axios.get('/api/profile',{headers:{Authorization:\"Bearer \".concat(token)}}).then(response=>{setProfile(response.data);}).catch(err=>{setError('Failed to load profile data');console.error('Error loading profile:',err.response?err.response.data:err.message);}).finally(()=>setLoading(false));}},[user]);const leaveEvent=eventId=>{const token=localStorage.getItem('authToken');if(!token){setError(\"Token is missing. Please log in again.\");return;}axios.delete('/api/events/leave',{headers:{Authorization:\"Bearer \".concat(token)},data:{userId:user.id,eventId}}).then(()=>{setProfile(prevProfile=>_objectSpread(_objectSpread({},prevProfile),{},{events:prevProfile.events.filter(event=>event.id_event!==eventId)}));}).catch(()=>{alert('Failed to leave event');});};if(!user){return/*#__PURE__*/_jsx(\"div\",{children:\"You are not authorized\"});}if(loading){return/*#__PURE__*/_jsx(\"div\",{children:\"Loading...\"});}if(error){return/*#__PURE__*/_jsx(\"div\",{children:error});}return/*#__PURE__*/_jsxs(\"div\",{className:\"profile-container\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Profile\"}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Name:\"}),\" \",profile===null||profile===void 0?void 0:profile.name]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Surname:\"}),\" \",profile===null||profile===void 0?void 0:profile.surname]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Email:\"}),\" \",profile===null||profile===void 0?void 0:profile.email]}),/*#__PURE__*/_jsx(\"h2\",{children:\"Events\"}),profile!==null&&profile!==void 0&&profile.events&&(profile===null||profile===void 0?void 0:profile.events.length)>0?/*#__PURE__*/_jsx(\"ul\",{children:profile.events.map(event=>/*#__PURE__*/_jsxs(\"li\",{children:[/*#__PURE__*/_jsxs(\"p\",{children:[event.name,\" - \",new Date(event.date).toLocaleDateString()]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>leaveEvent(event.id_event),children:\"Leave\"})]},event.id_event))}):/*#__PURE__*/_jsx(\"p\",{children:\"You are not participating in any events\"}),/*#__PURE__*/_jsx(\"button\",{className:\"logout-btn\",onClick:logoutUser,children:\"Log out\"})]});};export default ProfilePage;","map":{"version":3,"names":["React","useEffect","useState","axios","useAuth","jsx","_jsx","jsxs","_jsxs","ProfilePage","user","logoutUser","profile","setProfile","loading","setLoading","error","setError","token","localStorage","getItem","get","headers","Authorization","concat","then","response","data","catch","err","console","message","finally","leaveEvent","eventId","delete","userId","id","prevProfile","_objectSpread","events","filter","event","id_event","alert","children","className","name","surname","email","length","map","Date","date","toLocaleDateString","onClick"],"sources":["D:/Work/event-frontend/src/pages/ProfilePage.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport axios from 'axios';\r\nimport { useAuth } from '../context/AuthContext';\r\nimport './ProfilePage.css';\r\n\r\nconst ProfilePage = () => {\r\n    const { user, logoutUser } = useAuth();\r\n    const [profile, setProfile] = useState(null);\r\n    const [loading, setLoading] = useState(true);\r\n    const [error, setError] = useState(null);\r\n\r\n    useEffect(() => {\r\n        if (user) {\r\n            setLoading(true);\r\n            const token = localStorage.getItem('authToken');\r\n            if (!token) {\r\n                setError(\"Token is missing. Please log in again.\");\r\n                setLoading(false);\r\n                return;\r\n            }\r\n\r\n            axios\r\n                .get('/api/profile', {\r\n                    headers: {\r\n                        Authorization: `Bearer ${token}`,\r\n                    },\r\n                })\r\n                .then((response) => {\r\n                    setProfile(response.data);\r\n                })\r\n                .catch((err) => {\r\n                    setError('Failed to load profile data');\r\n                    console.error('Error loading profile:', err.response ? err.response.data : err.message);\r\n                })\r\n                .finally(() => setLoading(false));\r\n        }\r\n    }, [user]);\r\n\r\n    const leaveEvent = (eventId) => {\r\n        const token = localStorage.getItem('authToken');\r\n        if (!token) {\r\n            setError(\"Token is missing. Please log in again.\");\r\n            return;\r\n        }\r\n\r\n        axios\r\n            .delete('/api/events/leave', {\r\n                headers: {\r\n                    Authorization: `Bearer ${token}`,\r\n                },\r\n                data: { userId: user.id, eventId },\r\n            })\r\n            .then(() => {\r\n                setProfile((prevProfile) => ({\r\n                    ...prevProfile,\r\n                    events: prevProfile.events.filter((event) => event.id_event !== eventId),\r\n                }));\r\n            })\r\n            .catch(() => {\r\n                alert('Failed to leave event');\r\n            });\r\n    };\r\n\r\n    if (!user) {\r\n        return <div>You are not authorized</div>;\r\n    }\r\n\r\n    if (loading) {\r\n        return <div>Loading...</div>;\r\n    }\r\n\r\n    if (error) {\r\n        return <div>{error}</div>;\r\n    }\r\n\r\n    return (\r\n        <div className=\"profile-container\">\r\n            <h1>Profile</h1>\r\n            <p><strong>Name:</strong> {profile?.name}</p>\r\n            <p><strong>Surname:</strong> {profile?.surname}</p>\r\n            <p><strong>Email:</strong> {profile?.email}</p>\r\n\r\n            <h2>Events</h2>\r\n            {profile?.events && profile?.events.length > 0 ? (\r\n                <ul>\r\n                    {profile.events.map((event) => (\r\n                        <li key={event.id_event}>\r\n                            <p>{event.name} - {new Date(event.date).toLocaleDateString()}</p>\r\n                            <button onClick={() => leaveEvent(event.id_event)}>Leave</button>\r\n                        </li>\r\n                    ))}\r\n                </ul>\r\n            ) : (\r\n                <p>You are not participating in any events</p>\r\n            )}\r\n\r\n            <button className=\"logout-btn\" onClick={logoutUser}>Log out</button>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default ProfilePage;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}